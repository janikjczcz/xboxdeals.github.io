!function(t,i,s){t.fn.cutList=function(){var s=function(t,i){var s,e={};for(s in t)Object.prototype.hasOwnProperty.call(t,s)&&(e[s]=t[s]);for(s in i)Object.prototype.hasOwnProperty.call(i,s)&&(e[s]=i[s]);return e}({moreBtnTitle:"Еще",showMoreOnHover:!1,alwaysVisibleElem:void 0,risezeDelay:50},arguments[0]);return this.each(function(){var e,n,o,l,d,r=t(this),c=t(this).clone();function _(){clearTimeout(d),d=setTimeout(function(){var i;i=r,e,t.when(function(i){i.find(".cut-list__more .cut-list__elem").each(function(){var s=t(this).data("index");0==s?t(this).prependTo(i):t(this).insertAfter(i.find('.cut-list__elem[data-index="'+(s-1)+'"]'))})}(i)).done(function(){u(i)})},s.risezeDelay)}function a(n){n.find(".cut-list__dropdown").length||n.append('<div style="display:none" class="cut-list__elem cut-list__dropdown"></div>').find(".cut-list__dropdown").append('<div class="cut-list__drop"></div>').find(".cut-list__drop").append('<div class="cut-list__drop-toggle">'+s.moreBtnTitle+"</div>").append('<div class="cut-list__more"><div class="cut-list__more-content"></div></div>'),n.addClass("cut-list").children().each(function(i){t(this).attr("data-index",i).addClass("cut-list__elem")}),e=n.find(".cut-list__elem").length,index=e-1,n.find(s.alwaysVisibleElem).length>1&&console.log("Внимание! Вами назначено несколько alwaysVisibleElem, будет использоваться только первый."),l=n.find(s.alwaysVisibleElem+":first").index(),u(n),s.showMoreOnHover?n.find(".cut-list__drop").hover(function(){t(this).parents(".cut-list__dropdown").addClass("is-show"),f(t(this).parents(".cut-list__dropdown").find(".cut-list__more"))},function(){t(this).parents(".cut-list__dropdown").removeClass("is-show").find(".cut-list__more").hide().removeClass("is-top is-left")}):(n.find(".cut-list__drop-toggle").on("click",function(){t(this).parents(".cut-list__dropdown").is(".is-show")?t(this).parents(".cut-list__dropdown").removeClass("is-show").find(".cut-list__more").hide().removeClass("is-top is-left"):(t(this).parents(".cut-list__dropdown").addClass("is-show"),f(t(this).parents(".cut-list__dropdown").find(".cut-list__more")))}),t(document).on("click",function(i){t(i.target).closest(".cut-list__dropdown").length||t(".cut-list__dropdown.is-show").removeClass("is-show").find(".cut-list__more").hide().removeClass("is-top is-left")})),t(i).on("resize",_)}function u(i){n=i.innerWidth(),o=i.find(".cut-list__dropdown").outerWidth(!0);var d='.cut-list__elem:not(".cut-list__dropdown")';-1!=l&&(o+=i.find(s.alwaysVisibleElem+":first").outerWidth(!0),d='.cut-list__elem:not(".cut-list__dropdown,'+s.alwaysVisibleElem+':first")'),i.find(d).each(function(d){if((o+=t(this).outerWidth(!0))>=n)return function(t,i){var d='.cut-list__elem:not(".cut-list__dropdown")';-1!=l&&(d='.cut-list__elem:not(".cut-list__dropdown,'+s.alwaysVisibleElem+':first")');for(x=i;x<=e;x++)t.find(d+'[data-index="'+x+'"]').appendTo(t.find(".cut-list__more-content"));-1!=l&&t.find(".cut-list__elem:first").is(s.alwaysVisibleElem)&&(n=t.innerWidth(),(o=t.find(".cut-list__dropdown").outerWidth(!0)+t.find(s.alwaysVisibleElem+":first").outerWidth(!0))>=n&&t.find('.cut-list__elem:not(".cut-list__dropdown")[data-index="'+t.find(s.alwaysVisibleElem+":first").data("index")+'"]').appendTo(t.find(".cut-list__more-content")))}(i,-1!=l&&d>l?d+1:d),i.addClass("with-more-items").find(".cut-list__dropdown").show(),!1;i.removeClass("with-more-items").find(".cut-list__dropdown").hide()})}function f(i){var s=t(document).outerHeight(!0);i.css("visibility","hidden").show(),i.offset().top+i.innerHeight()>s&&i.addClass("is-top"),i.offset().left<0&&i.addClass("is-left"),i.css("visibility","visible")}a(r),t.fn.cutList.setup=function(){a(r)},t.fn.cutList.destroy=function(){r.html(c.html()),t(i).off("resize",_)}})}}(jQuery,window);
